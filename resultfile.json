{"items":[{"owner":{"reputation":8,"user_id":7437225,"user_type":"registered","accept_rate":75,"profile_image":"https://www.gravatar.com/avatar/45b4084e2de1f67c34121dde1032e912?s=128&d=identicon&r=PG&f=1","display_name":"Deep Jadia","link":"https://stackoverflow.com/users/7437225/deep-jadia"},"is_accepted":false,"score":0,"last_activity_date":1504595654,"last_edit_date":1504595654,"creation_date":1504594491,"answer_id":46048689,"question_id":15541228,"body":"<pre><code>HttpWebRequest httpWReq =\n                (HttpWebRequest)WebRequest.Create(\"https://api.box.com/oauth2/token\");\n\n            ASCIIEncoding encoding = new ASCIIEncoding();\n            string postData = \"grant_type=authorization_code\";\n            postData += \"&amp;code=\" + authorizationCode;\n            postData += \"&amp;client_id=\" + ClientId;\n            postData += \"&amp;client_secret=\" + ClientSecretId;\n            byte[] data = encoding.GetBytes(postData);\n\n            httpWReq.Method = \"POST\";\n            httpWReq.ContentType = \"application/x-www-form-urlencoded\";\n            //httpWReq.ContentType = \"application/x-www-form-urlencoded\";\n            httpWReq.ContentLength = data.Length;\n\n            using (Stream stream = httpWReq.GetRequestStream())\n            {\n                stream.Write(data, 0, data.Length);\n            }\n</code></pre>\n"},{"owner":{"reputation":56,"user_id":685762,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/81321849da72cbb36fabf783321bd6e8?s=128&d=identicon&r=PG","display_name":"ReenL","link":"https://stackoverflow.com/users/685762/reenl"},"is_accepted":false,"score":1,"last_activity_date":1504208952,"creation_date":1504208952,"answer_id":45989059,"question_id":45478218,"body":"<p>I won't recommend you to implement this yourself since there are already a couple of libraries implementing this protocol. However I split my answer into 2 parts the first part explains how to use an open source package to solve your problem, the second part helps you out if you want to do private keys signing.</p>\n\n<h2>Using a package</h2>\n\n<p>There are a couple of php packages that support JWT signing, at the moment of writing the one that is used most is <strong>lcobucci/jwt</strong>, but there are also other implementations found here:\n<a href=\"https://packagist.org/search/?q=jwt\" rel=\"nofollow noreferrer\">https://packagist.org/search/?q=jwt</a></p>\n\n<p>You can use <a href=\"https://getcomposer.org\" rel=\"nofollow noreferrer\">composer</a> to install it. Since version 4.0 is not documented right now I suggest you install 3.2 and have a look at the <a href=\"https://github.com/lcobucci/jwt/blob/3.2/README.md\" rel=\"nofollow noreferrer\">README</a> file of that version.</p>\n\n<p>You can require this in your project using: <code>composer require lcobucci/jwt:^3.2</code></p>\n\n<p>Your code sample suggests you need RSA256, the library has an example for that:</p>\n\n<pre><code>&lt;?php\nuse Lcobucci\\JWT\\Builder;\nuse Lcobucci\\JWT\\Signer\\Keychain; // just to make our life simpler\nuse Lcobucci\\JWT\\Signer\\Rsa\\Sha256; // you can use Lcobucci\\JWT\\Signer\\Ecdsa\\Sha256 if you're using ECDSA keys\n\n$signer = new Sha256();\n$keychain = new Keychain();\n$token = (new Builder())\n    -&gt;setIssuer('http://example.com') // Configures the issuer (iss claim)\n    -&gt;setAudience('http://example.org') // Configures the audience (aud claim)\n    -&gt;setId('4f1g23a12aa', true) // Configures the id (jti claim), replicating as a header item\n    -&gt;setIssuedAt(time()) // Configures the time that the token was issue (iat claim)\n    -&gt;setNotBefore(time() + 60) // Configures the time that the token can be used (nbf claim)\n    -&gt;setExpiration(time() + 3600) // Configures the expiration time of the token (nbf claim)\n    -&gt;set('uid', 1) // Configures a new claim, called \"uid\"\n    -&gt;sign($signer,  $keychain-&gt;getPrivateKey('file://{path to your private key}')) // creates a signature using your private key\n    -&gt;getToken(); // Retrieves the generated token\n</code></pre>\n\n<h2>Signing and verifying</h2>\n\n<p>When using public and private keys you always have to be sure to keep your private key safe. You can however easily publish your public key to the world without compromising security.</p>\n\n<p>Signing is done using the private key, since you don't want people to be able to fake your signature, signing with the public part would make it possible for everyone to do it. This also means that the verify step always uses the public key, because everyone should be able to do it.</p>\n\n<h2>Doing it in PHP</h2>\n\n<p>The code example you provided simply loads a private key, but does not do any action with it. In order to sign you will need to use <code>openssl_sign</code> with your variable. <code>Resource #xx</code> simply means a reference to something external in php.</p>\n\n<pre><code>&lt;?php\n// Data to sign\n$payload = 'TEST';\n// Generate a new key, load with: openssl_pkey_get_private\n$privateKey = openssl_pkey_new(array('private_key_bits' =&gt; 512)); // NOT SECURE BUT FAST\n// Extract public part from private key\n$details = openssl_pkey_get_details($privateKey);\n// Use openssl_pkey_get_public to load from file\n$publicKey = $details['key'];\n\n// Generated by openssl_sign\n$signature = null;\n// Sign with private key\nopenssl_sign($payload, $signature, $privateKey, OPENSSL_ALGO_SHA256);\n\n// Use base64 because the signature contains binairy data\necho 'Signed data: '.base64_encode($signature).PHP_EOL;\n\n// Use publicKey to verify signature\n$valid = openssl_verify($payload, $signature, $publicKey, OPENSSL_ALGO_SHA256);\necho 'Signature is '.($valid ? 'Valid' : 'Invalid').PHP_EOL;\n</code></pre>\n\n<h2>What else</h2>\n\n<p>If you still want to implement the complete protocol I suggest you have another look at the package. And as already suggested by the comments the complete specification:</p>\n\n<p><a href=\"https://www.rfc-editor.org/rfc/rfc7519.txt\" rel=\"nofollow noreferrer\">https://www.rfc-editor.org/rfc/rfc7519.txt</a></p>\n\n<p>Last hint: JWT uses some different characters for base64 than php so be sure to handle that correctly.</p>\n"},{"owner":{"reputation":636,"user_id":2894210,"user_type":"registered","accept_rate":62,"profile_image":"https://i.stack.imgur.com/cVlcx.png?s=128&g=1","display_name":"Rajesh Manilal","link":"https://stackoverflow.com/users/2894210/rajesh-manilal"},"is_accepted":true,"score":2,"last_activity_date":1491546783,"creation_date":1491546783,"answer_id":43271181,"question_id":43253959,"body":"<p>With respect to @Miguel-F's comment, I've surfed and found a solution from <a href=\"https://www.bennadel.com/blog/934-ask-ben-handling-redirects-with-coldfusion-cfhttp.htm\" rel=\"nofollow noreferrer\" title=\"Ben Nadel&#39;s post\">Ben Nadel's post</a>.</p>\n\n<p>I've got 200 as response, this is because ColdFusion followed the redirect to dl.boxcloud.com (since by default, the REDIRECT attribute is TRUE), and the redirected request's response is 200. </p>\n\n<p>Actually we should stop the redirect by setting REDIRECT attribute to <code>FALSE</code>. So that Coldfusion will return actual response to the invoking code. </p>\n\n<p>So I've set REDIRECT attribute to <code>FALSE</code>. </p>\n\n<pre><code>&lt;cfhttp url=\"https://api.box.com/2.0/files/(FILE_ID)/content/\" method=\"GET\" redirect=\"false\" &gt;\n&lt;cfhttpparam type=\"header\" name=\"Authorization\" value=\"Bearer (DEVELOPER_TOKEN)\"&gt;\n&lt;/cfhttp&gt;\n</code></pre>\n\n<p>And now I'm getting <code>302 found</code> as response as per the <a href=\"https://docs.box.com/reference#download-a-file\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3kBxT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3kBxT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>With this response, we're having <code>Location</code> key (in which the code was redirected earlier) in the ResponseHeader.  So by using the Location URL we can download the file using CFHEADER and CFCONTENT tags.</p>\n\n<p><strong>Reference :</strong> <a href=\"https://www.bennadel.com/blog/934-ask-ben-handling-redirects-with-coldfusion-cfhttp.htm\" rel=\"nofollow noreferrer\">https://www.bennadel.com/blog/934-ask-ben-handling-redirects-with-coldfusion-cfhttp.htm</a> </p>\n"},{"owner":{"reputation":11,"user_id":4640356,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/ae1b37cee9dd92450d28921cd5c06401?s=128&d=identicon&r=PG&f=1","display_name":"Wuttipol Madsen","link":"https://stackoverflow.com/users/4640356/wuttipol-madsen"},"is_accepted":false,"score":1,"last_activity_date":1491517352,"last_edit_date":1491517352,"creation_date":1427958339,"answer_id":29406977,"question_id":21613359,"body":"<p>According to Sikppy Ta</p>\n\n<p>You can save your first token in the file and using the refresh mechanism via such file.</p>\n\n<p>Here is example</p>\n\n<pre><code>static String tokenUrl = \"https://app.box.com/api/oauth2/token\";\n\npublic String getTokenFromFile() throws Exception {\n\n    String path = this.tokenFilePath;\n    File file = new File(path);\n    String line = \"\", token = \"\";\n    try {\n        BufferedReader br = new BufferedReader(new FileReader(file));\n        while ((line = br.readLine()) != null) {\n            token = line;\n        }\n        br.close();\n    } catch (IOException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n    String newRefleshToken = refleshToken(token);\n    String accessToken = newRefleshToken.substring(17, 49);\n    return accessToken;\n}\n</code></pre>\n\n<p>For refreshToken, you need the HTTPClient</p>\n\n<pre><code>private String refleshToken(String tokencode) throws Exception {\n    String accessToken = tokencode.substring(17, 49);\n    String refleshToken = tokencode.substring(105, 169);\n    tokencode = HttpURLConnectionExample.refreshToken(refleshToken);\n        writeTokenToTextFile(tokencode);\n        return tokencode;\n    }\n\n public static String refreshToken(String newToken) throws Exception {\n\n\n    String urlParameters = \"grant_type=refresh_token&amp;refresh_token=\" + newToken + \"&amp;client_id=\" + client_id + \"&amp;client_secret=\" + client_secret;\n\n    String result = sendPost(tokenUrl, urlParameters);\n    return result;\n}\n</code></pre>\n\n<p>Let me show the sendPost method</p>\n\n<pre><code>String sendPost(String url, String urlParameters) throws Exception {\n\n   URL obj = new URL(url);\n   HttpsURLConnection con = (HttpsURLConnection) obj.openConnection();\n\n   //add reuqest header\n   con.setRequestMethod(\"POST\");\n   con.setRequestProperty(\"User-Agent\", USER_AGENT);\n   con.setRequestProperty(\"Accept-Language\", \"en-US,en;q=0.5\");\n\n   // Send post request\n   con.setDoOutput(true);\n   DataOutputStream wr = new DataOutputStream(con.getOutputStream());\n   wr.writeBytes(urlParameters);\n   wr.flush();\n   wr.close();\n\n   int responseCode = con.getResponseCode();\n   System.out.println(\"Response Code : \" + responseCode);\n\n   BufferedReader in = new BufferedReader(\n           new InputStreamReader(con.getInputStream()));\n   String inputLine;\n   StringBuffer response = new StringBuffer();\n\n   while ((inputLine = in.readLine()) != null) {\n       response.append(inputLine);\n   }\n   in.close();\n\n   return response.toString();\n}\n</code></pre>\n"},{"owner":{"reputation":12,"user_id":3773287,"user_type":"registered","profile_image":"https://i.stack.imgur.com/8gEIX.jpg?s=128&g=1","display_name":"Kumar","link":"https://stackoverflow.com/users/3773287/kumar"},"is_accepted":false,"score":0,"last_activity_date":1487393643,"last_edit_date":1487393643,"creation_date":1447768012,"answer_id":33758555,"question_id":15269989,"body":"<p>I have also face same issue implementing oauth2. I have add <code>Content-Type: application/x-www-form-urlencoded</code>. When I add <code>content-type</code> my issue solved. </p>\n\n<p>Check and add valid <code>content-type</code>. </p>\n"},{"owner":{"reputation":343,"user_id":3751589,"user_type":"registered","accept_rate":64,"profile_image":"https://www.gravatar.com/avatar/6c161490b1b72a7b7a7c2ddd35efa747?s=128&d=identicon&r=PG&f=1","display_name":"Kevin","link":"https://stackoverflow.com/users/3751589/kevin"},"is_accepted":false,"score":2,"last_activity_date":1479752846,"creation_date":1479752846,"answer_id":40726987,"question_id":23730283,"body":"<p>I had a similar problem with relative paths like @Guilherme did too. I was running my bash script with:</p>\n\n<pre><code>bash test/script.sh\n</code></pre>\n\n<p>However, my file was in the same directory level as the bash script and not the <code>test</code> directory (where I was calling bash from), so the script could not find my file.</p>\n\n<p><strong>Solution for me:</strong><br>\n1. cd into /test and run bash script.sh from there<br>\n2. Use absolute paths</p>\n"},{"owner":{"reputation":906,"user_id":1718128,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/91048b06403e921a28a83ba4bdc708d5?s=128&d=identicon&r=PG","display_name":"Adam Huffman","link":"https://stackoverflow.com/users/1718128/adam-huffman"},"is_accepted":false,"score":1,"last_activity_date":1478818624,"creation_date":1478818624,"answer_id":40538473,"question_id":34233756,"body":"<p>It appears that the Enterprise ID is embedded on most pages, even the <em>/files</em> page. It can be accessed by opening the browser's console and entering in <code>window.initialConfig[\"enterpriseId\"]</code> or <code>console.log(window.initialConfig[\"enterpriseId\"]);</code>.</p>\n\n<p>Even though that will give you the Enterprise ID the application will still need to be approved by an Enterprise Admin.</p>\n"},{"owner":{"reputation":557,"user_id":3791767,"user_type":"registered","accept_rate":60,"profile_image":"https://i.stack.imgur.com/V2Ocj.jpg?s=128&g=1","display_name":"kendomen","link":"https://stackoverflow.com/users/3791767/kendomen"},"is_accepted":false,"score":0,"last_activity_date":1478068434,"creation_date":1478068434,"answer_id":40373760,"question_id":39072124,"body":"<pre><code>private static BoxSharedLink createSharedLink(BoxAPIConnection api, String fileId) {\n    BoxFile file = new BoxFile(api, fileId);\n    BoxSharedLink.Permissions permissions = new BoxSharedLink.Permissions();\n    permissions.setCanDownload(true);\n    permissions.setCanPreview(true);\n    Date date = new Date();\n\n    Calendar unshareAt = Calendar.getInstance();\n    unshareAt.setTime(date);\n    unshareAt.add(Calendar.DATE, 14);\n\n    BoxSharedLink sharedLink = file.createSharedLink(BoxSharedLink.Access.COMPANY, unshareAt.getTime(), permissions);\n    logger.info(\"shared link: \" + sharedLink.getURL());\n    return  sharedLink;\n}\n</code></pre>\n"},{"owner":{"reputation":1,"user_id":6946502,"user_type":"registered","profile_image":"https://lh3.googleusercontent.com/-K8pxctUaHqo/AAAAAAAAAAI/AAAAAAAAFEs/N5ReEIMRUz8/photo.jpg?sz=128","display_name":"Nihar Biswal","link":"https://stackoverflow.com/users/6946502/nihar-biswal"},"is_accepted":false,"score":0,"last_activity_date":1476053370,"creation_date":1476053370,"answer_id":39949318,"question_id":39072124,"body":"<p>I just passed \"null\" in place of unsharedDate..I am able to get a shared link.</p>\n\n<p>BoxSharedLink sharedLink = file.createSharedLink(\n                BoxSharedLink.Access.OPEN, null, permissions);</p>\n\n<p>I am not sure what null value means. I am guessing there is no unsharedDate set if you pass null. couldn't find any api documentation for this.</p>\n"},{"owner":{"reputation":26,"user_id":3047626,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/453ca40388588ffe47e1f4fac24096c3?s=128&d=identicon&r=PG&f=1","display_name":"mnikolic","link":"https://stackoverflow.com/users/3047626/mnikolic"},"is_accepted":false,"score":0,"last_activity_date":1474821660,"creation_date":1474821660,"answer_id":39689289,"question_id":33445955,"body":"<p>I had exactly the same problem, with the same error message from Box and the JWT verifying correctly in jwt.io.</p>\n\n<p>It turns out that the problem was in Base64 vs Base64Url encoding. As Brian pointed, jwt.io can use both Base64 and Base64Url encoding, but Box requires Base64Url. The framework I am using uses Base64 by default and this was the problem and after forcing Base64Url on all parts of the JWT assertion, Box login succeeded.</p>\n"},{"owner":{"reputation":15,"user_id":5806602,"user_type":"registered","accept_rate":40,"profile_image":"https://www.gravatar.com/avatar/58510692cf8e4aceba9ec145be00c26c?s=128&d=identicon&r=PG&f=1","display_name":"Andy Cass","link":"https://stackoverflow.com/users/5806602/andy-cass"},"is_accepted":false,"score":0,"last_activity_date":1473648927,"last_edit_date":1473648927,"creation_date":1473643785,"answer_id":39442286,"question_id":16557657,"body":"<p>Call listFilesInBoxFolders(\"0\")  ---> This will parse all files and folders starting from root</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public void listFilesInBoxFolders(String folderId) {\n\n    try {\n        // get a list of songs\n        BoxApiFolder folderApi = new BoxApiFolder(mSession);\n        BoxListItems items = folderApi.getItemsRequest(folderId).send();\n\n        JSONObject object = new JSONObject(items.toJson());\n\n        LogUtils.log(TAG, \"Object \" + object.toString());\n\n        JSONArray array = object.getJSONArray(\"entries\");\n\n        for (int i = 0; i &lt; array.length(); i++) {\n            JSONObject object1 = array.getJSONObject(i);\n            String type = object1.getString(\"type\");\n            String id = object1.getString(\"id\");\n            String name = object1.getString(\"name\");\n            if (type.equals(\"folder\")) {\n                listFilesInBoxFolders(id);\n            } else if (type.equals(\"file\")) {\n                // Supported Media file types\n                if (name.contains(\"mp3\") || name.contains(\"m4a\") || name.contains(\"flac\")) {\n                    musicItems.add(new BoxMusicItem(id, name));\n                }\n            }\n        }\n\n        LogUtils.log(TAG, \"array \" + array.toString());\n\n    } catch (BoxException e) {\n        e.printStackTrace();\n    } catch (JSONException e) {\n        e.printStackTrace();\n        LogUtils.log(TAG, \"Json Error\");\n    }\n    // For testing to make sure i have all files in box\n    printFilesInBox();\n }\n</code></pre>\n"},{"owner":{"reputation":11,"user_id":4674820,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/c123ac8f8901fa747f5d8134ecafd025?s=128&d=identicon&r=PG&f=1","display_name":"Luis Cruz","link":"https://stackoverflow.com/users/4674820/luis-cruz"},"is_accepted":false,"score":1,"last_activity_date":1471629568,"last_edit_date":1471629568,"creation_date":1471620864,"answer_id":39042885,"question_id":23730283,"body":"<p>I was having this problem this morning but I solved with this</p>\n\n<pre><code>fileUpload=@\\\"file, with comma .txt\\\"\n</code></pre>\n\n<p>So you have to put some double quotes around the file name if you have commas in the file name ( \\\" )</p>\n"},{"owner":{"reputation":1101,"user_id":3639923,"user_type":"registered","profile_image":"https://i.stack.imgur.com/QTYOK.jpg?s=128&g=1","display_name":"Murtza Manzur","link":"https://stackoverflow.com/users/3639923/murtza-manzur"},"is_accepted":true,"score":1,"last_activity_date":1469500606,"creation_date":1469500606,"answer_id":38580220,"question_id":38348893,"body":"<p>As you mentioned, App Users are designed to be used with App Auth (JWT Authentication). App Users are API-only users in Box. For example, if you are building an application and need a place to store and access files on behalf of your end users, you can use App Users for this.</p>\n\n<p>For your use case, it sounds like you need to access Enterprise content from Managed Users. To access this data, you will need to implement <a href=\"https://docs.box.com/docs/oauth-20\" rel=\"nofollow\">Box's OAuth process</a>.</p>\n"},{"owner":{"reputation":11,"user_id":6350364,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/56761db4b0418abb60b972d152522e8b?s=128&d=identicon&r=PG","display_name":"AmirW","link":"https://stackoverflow.com/users/6350364/amirw"},"is_accepted":false,"score":1,"last_activity_date":1463569262,"last_edit_date":1463569262,"creation_date":1463567067,"answer_id":37296807,"question_id":20252226,"body":"<p>If I understand correctly you want the entire process to be automated so it would not require a user login (i.e run a script and the file is uploaded).\nWell, it is possible. I am a rookie developer so excuse me if I'm not using the correct terms.</p>\n\n<p>Anyway, this can be accomplished by using cURL.\nFirst you need to define some variables, your user credentials (username and password), your client id and client secret given by Box (found in your app), your redirect URI and state (used for extra safety if I understand correctly).</p>\n\n<p>The <code>oAuth2.0</code> is a 4 step authentication process and you're going to need to go through each step individually.</p>\n\n<p>The first step would be setting a curl instance:</p>\n\n<pre><code>curl_setopt_array($curl, array(\n\n   CURLOPT_URL =&gt; \"https://app.box.com/api/oauth2/authorize\",\n\n   CURLOPT_RETURNTRANSFER =&gt; true,\n\n   CURLOPT_ENCODING =&gt; \"content-type: application/x-www-form-urlencoded\",\n\n   CURLOPT_MAXREDIRS =&gt; 10,\n\n   CURLOPT_TIMEOUT =&gt; 30,\n\n   CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,\n\n   CURLOPT_CUSTOMREQUEST =&gt; \"POST\",\n\n   CURLOPT_POSTFIELDS =&gt;\n \"response_type=code&amp;client_id=\".$CLIENT_ID.\"&amp;state=\".$STATE,\n\n));\n</code></pre>\n\n<p>This will return an html text with a request token, you will need it for the next step so I would save the entire output to a variable and grep the tag with the request token (the tag has a <code>\"name\" = \"request_token\"</code> and a <code>\"value\"</code> which is the actual token).</p>\n\n<p>Next step you will need to send another curl request to the same url, this time the post fields should include the request token, user name and password as follows:</p>\n\n<pre><code>CURLOPT_POSTFIELDS =&gt; \"response_type=code&amp;client_id=\".$CLIENT_ID.\"&amp;state=\".$STATE.\"&amp;request_token=\".$REQ_TOKEN.\"&amp;login=\".$USER_LOGIN.\"&amp;password=\".$PASSWORD\n</code></pre>\n\n<p>At this point you should also set a cookie file:</p>\n\n<pre><code>  CURLOPT_COOKIEFILE =&gt; $COOKIE, (where $COOKIE is the path to the cookie file)\n</code></pre>\n\n<p>This will return another html text output, use the same method to grep the token which has the name \"ic\".</p>\n\n<p>For the next step you're going to need to send a post request to the same url. It should include the postfields:</p>\n\n<pre><code>response_type=code&amp;client_id=\".$CLIENT_ID.\"&amp;state=\".$STATE.\"&amp;redirect_uri=\".$REDIRECT_URI.\"&amp;doconsent=doconsent&amp;scope=root_readwrite&amp;ic=\".$IC\n</code></pre>\n\n<p>Be sure to set the curl request to use the cookie file you set earlier like this:</p>\n\n<pre><code>CURLOPT_COOKIEFILE =&gt; $COOKIE,\n</code></pre>\n\n<p>and include the header in the request:</p>\n\n<pre><code>CURLOPT_HEADER =&gt; true,\n</code></pre>\n\n<p>At step (if done by browser) you will be redirected to a URL which looks as described above:</p>\n\n<pre><code>http://0.0.0.0(*redirect uri*)/?state=[box-generated_state_security_token]&amp;code=[SOME_CODE] and note the \"code=\" value.\n</code></pre>\n\n<p>Grab the value of <code>\"code\"</code>.</p>\n\n<p>Final step!</p>\n\n<p>send a new cur request to https//app.box.com/api/oauth2/token\nThis should include fields:</p>\n\n<pre><code>CURLOPT_POSTFIELDS =&gt; \"grant_type=authorization_code&amp;code=\".$CODE.\"&amp;client_id=\".$CLIENT_ID.\"&amp;client_secret=\".$CLIENT_SECRET,\n</code></pre>\n\n<p>This will return a string containing \"access token\", \"Expiration\" and \"Refresh token\".\nThese are the tokens needed for the upload.\nread about the use of them here:\n<a href=\"https://box-content.readme.io/reference#upload-a-file\" rel=\"nofollow\">https://box-content.readme.io/reference#upload-a-file</a></p>\n\n<p>Hope this is somewhat helpful.\nP.S,\nI separated the https on purpuse (Stackoverflow wont let me post an answer with more than 1 url :D)\nthis is for PHP cURL. It is also possible to do the same using Bash cURL. </p>\n"},{"owner":{"reputation":537,"user_id":2861283,"user_type":"registered","accept_rate":20,"profile_image":"https://www.gravatar.com/avatar/857a4bcdc6e7a425e4a2dc9ad25cba32?s=128&d=identicon&r=PG&f=1","display_name":"Rakesh Chaudhari","link":"https://stackoverflow.com/users/2861283/rakesh-chaudhari"},"is_accepted":false,"score":0,"last_activity_date":1463468796,"creation_date":1463468796,"answer_id":37269342,"question_id":21227891,"body":"<p>For accessing access_token using java sdk , You need to have following key values </p>\n\n<p>1) clienId > Use Application console</p>\n\n<p>2) client_secret > Use application console</p>\n\n<p>3) code > Code value you will get using below link \n<a href=\"https://account.box.com/api/oauth2/authorize?response_type=code&amp;client_id=\" rel=\"nofollow\">https://account.box.com/api/oauth2/authorize?response_type=code&amp;client_id=</a>{your_client_id}&amp;state=security_token%3DKnhMJatFipTAnM0nHlZA</p>\n\n<p>Replace your client id with original value. client id you will get from your apps.</p>\n\n<p>And Follow steps and authorize you application using your credential.</p>\n\n<p>after that it will redirect to   <a href=\"https://localhost/?state=security_token%3DKnhMJatFipTAnM0nHlZA&amp;code=sdsdsd3sdsdC0oGqOS2WgaFipZBdj\" rel=\"nofollow\">https://localhost/?state=security_token%3DKnhMJatFipTAnM0nHlZA&amp;code=sdsdsd3sdsdC0oGqOS2WgaFipZBdj</a></p>\n\n<p>Copy code value </p>\n\n<pre><code>String clienId = \"your client id \";\n\nString client_secret = \"your secret id\"; \n\nString code = \"sdsdsd3sdsdC0oGqOS2WgaFipZBdj\"; // use above extracted  code value \nBoxAPIConnection con = new BoxAPIConnection(clienId,client_secret,code);\n\nString accessToken = con.getAccessToken();\n\nSystem.out.println(\"Accss_Token : \" +accessToken);\n</code></pre>\n"},{"owner":{"reputation":11,"user_id":6342108,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/00c07eb542f64f5b4a3890cfdac121e7?s=128&d=identicon&r=PG&f=1","display_name":"Sarah Pads","link":"https://stackoverflow.com/users/6342108/sarah-pads"},"is_accepted":false,"score":1,"last_activity_date":1463422053,"last_edit_date":1463422053,"creation_date":1463421751,"answer_id":37260316,"question_id":37187429,"body":"<p>I just struggled with this myself.  I was able to get this to work by moving everything you currently have in boxOptions.form into the request body.</p>\n\n<p>For example:</p>\n\n<pre><code>var boxHeaders = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nvar boxOptions = {\n  url: 'https://api.box.com/oauth2/token',\n  method: 'POST',\n  headers: boxHeaders\n};\n\nvar form = {\n  grant_type:'urn:ietf:params:oauth:grant-type:jwt-bearer',\n  client_id: 'id',\n  client_secret: 'secret',\n  assertion: boxtoken\n};\n\nvar request = https.request(boxOptions, function(response) {\n  // do stuff\n});\n\nrequest.write(querystring.stringify(form));\nrequest.end();\n</code></pre>\n\n<p>Hope this helps.  Unfortunately, I'm not familiar enough with the request library to provide an example using it.</p>\n"},{"owner":{"reputation":371,"user_id":6229559,"user_type":"registered","profile_image":"https://i.stack.imgur.com/rsKS2.jpg?s=128&g=1","display_name":"M.Qassas","link":"https://stackoverflow.com/users/6229559/m-qassas"},"is_accepted":false,"score":1,"last_activity_date":1461157392,"creation_date":1461157392,"answer_id":36744704,"question_id":24363946,"body":"<p>This occur when your page embed HTTP unsecured Content/Scripts into HTTPS secured environment and might be the SSL certificate is configured on Load-Balancer not application server therefore, the traffic is encrypted up to the Load-Balancer, then itâ€™s in clear between the Load-Balancer and the application server that called SSL offloadingso i think you will require to enable mix contents in IE or load unsecure scripts in Chrome.\nFor more details check <a href=\"https://mohamedelkassas.wordpress.com/2016/04/20/this-page-is-trying-to-load-scripts-from-unauthenticated-sources-when-starting-approval-workflow-in-sharepoint-2013/\" rel=\"nofollow\">this</a></p>\n"},{"owner":{"reputation":1101,"user_id":3639923,"user_type":"registered","profile_image":"https://i.stack.imgur.com/QTYOK.jpg?s=128&g=1","display_name":"Murtza Manzur","link":"https://stackoverflow.com/users/3639923/murtza-manzur"},"is_accepted":false,"score":0,"last_activity_date":1459824648,"creation_date":1459824648,"answer_id":36416289,"question_id":25463885,"body":"<p>Here is the object format for the accessible_by parameter used in the Create Collaboration endpoint:</p>\n\n<pre><code>\"accessible_by\": { \"id\": \"USER_ID\", \"type\": \"user\" }\n</code></pre>\n"},{"owner":{"reputation":1441,"user_id":2781862,"user_type":"registered","accept_rate":80,"profile_image":"https://www.gravatar.com/avatar/d39e4b258fe2d5beaae5ff9f803c6cb9?s=128&d=identicon&r=PG&f=1","display_name":"Emil Borconi","link":"https://stackoverflow.com/users/2781862/emil-borconi"},"is_accepted":false,"score":0,"last_activity_date":1455662641,"creation_date":1455662641,"answer_id":35444473,"question_id":11058475,"body":"<p>Here is my approach on how to get a folder id based on a path, without recursively going through the whole tree, this can be easily adapted for file as well. This is based on PHP and CURL, but it's very easy to use it in any other application as well:</p>\n\n<pre><code>//WE SET THE SEARCH FOLDER:\n$search_folder=\"XXXX/YYYYY/ZZZZZ/MMMMM/AAAAA/BBBBB\";\n\n//WE NEED THE LAST BIT SO WE CAN DO A SEARCH FOR IT\n$folder_structure=array_reverse (explode(\"/\",$search_folder));\n\n// We run a CURL (I'm assuming all the authentication and all other CURL parameters are already set!) to search for the last bit, if you want to search for a file rather than a folder, amend the search query accordingly\ncurl_setopt($curl, CURLOPT_URL, \"https://api.box.com/2.0/search?query=\".urlencode($folder_structure[0]).\"&amp;type=folder\");    \n\n// Let's make a cine array out of that response\n$json=json_decode(curl_exec($curl),true);\n$i=0;\n$notthis=true;\n\n// We need to loop trough the result, till either we find a matching element, either we are at the end of the array\nwhile ($notthis &amp;&amp; $i&lt;count($json['entries'])) {\n  $result_info=$json['entries'][$i];\n\n     //The path of each search result is kept in a multidimensional array, so we just rebuild that array, ignoring the first element (that is Always the ROOT)\n     if ($search_folder == implode(\"/\",array_slice(array_column($result_info['path_collection']['entries'],'name'),1)).\"/\".$folder_structure[0])\n        {\n         $notthis=false;\n         $folder_id=$result_info['id'];\n        }\n      else\n        {\n         $i++;  \n        }\n   }\nif ($notthis) {echo \"Path not found....\";} else {echo \"Folder id: $folder_id\";}\n</code></pre>\n"},{"owner":{"reputation":128,"user_id":2344054,"user_type":"registered","accept_rate":50,"profile_image":"https://i.stack.imgur.com/vayXG.png?s=128&g=1","display_name":"PlusInfinite","link":"https://stackoverflow.com/users/2344054/plusinfinite"},"is_accepted":true,"score":1,"last_activity_date":1454087811,"creation_date":1454087811,"answer_id":35090288,"question_id":34532337,"body":"<p>There is no limit in the Java SDK for Box API with regards to how many items will be returned. The <code>Iterable&lt;BoxItem.Info&gt;</code> returned by <code>BoxFolder.search()</code> will iterate until the Box API returns no more results (in batches of 200 items).</p>\n\n<p>Therefore, except if you are hitting some sort of an error in the communication with the Box API (use Charles Proxy or Fiddler or similar tool to monitor that), it means that you are hitting a scope issue. A possible explanation would be that when you search at box.com you search in enterprise scope, while when you search via the API you search in user scope. Can you check the results for that?</p>\n"},{"owner":{"reputation":6423,"user_id":1453907,"user_type":"registered","accept_rate":89,"profile_image":"https://www.gravatar.com/avatar/bc7565bb6466cd85e86fed459d947a43?s=128&d=identicon&r=PG","display_name":"John Hoerr","link":"https://stackoverflow.com/users/1453907/john-hoerr"},"is_accepted":true,"score":2,"last_activity_date":1451920321,"creation_date":1451920321,"answer_id":34594155,"question_id":34583902,"body":"<p>Your application must be manually approved by Box for <code>As-User</code> requests. The documentation <a href=\"https://box-content.readme.io/#as-user-1\" rel=\"nofollow\">mentions</a> this but it's easy to miss. To start the approval process <a href=\"http://community.box.com/t5/custom/page/page-id/BoxSearchLithiumTKB\" rel=\"nofollow\">send Box a note</a> and include your API Key.</p>\n"},{"owner":{"reputation":256,"user_id":4339059,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/e34ec5debc4661ceb4fb6474136d142a?s=128&d=identicon&r=PG&f=1","display_name":"Paul Paulauskas","link":"https://stackoverflow.com/users/4339059/paul-paulauskas"},"is_accepted":true,"score":9,"last_activity_date":1449876469,"creation_date":1449876469,"answer_id":34234231,"question_id":34233756,"body":"<p>You can find the Enterprise ID by going to the Admin Console -> Click the gear in the top right -> Click Business Settings (It may say Enterprise Settings or Elite Settings based on the account level). Under the Account Info tab you can see your Enterprise ID.</p>\n\n<p>You can also get directly to that page by going to\n<a href=\"https://www.box.com/master/settings\">https://www.box.com/master/settings</a> while logged into the account. Note that only enterprise admins / co-admins with sufficient permissions will have access to that page, otherwise it will redirect to the account settings. In this case, you would need to contact your enterprise admin to get this Enterprise ID.</p>\n"},{"owner":{"reputation":256,"user_id":4339059,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/e34ec5debc4661ceb4fb6474136d142a?s=128&d=identicon&r=PG&f=1","display_name":"Paul Paulauskas","link":"https://stackoverflow.com/users/4339059/paul-paulauskas"},"is_accepted":false,"score":0,"last_activity_date":1449602403,"creation_date":1449602403,"answer_id":34164204,"question_id":34114726,"body":"<p>Currently, the JWT Authentication is specific to accounts that are designated as App Users. Since they do not have their own login, and they are purely managed through an application, the JWT Auth method was implemented to allow for programmatic access.</p>\n\n<p>JWT is not meant as a replacement for the standard three-legged OAuth 2.0 approach for retrieving tokens for managed users, and as such, you should utilize the flow which is described in some more detail here:\n<a href=\"https://box-content.readme.io/docs/oauth-20\" rel=\"nofollow\">https://box-content.readme.io/docs/oauth-20</a></p>\n\n<p>The OAuth tokens are scoped based on who logs in through the application. If a managed user logs in, the access token received will have access to the content that the user has within the Box Web App. If an enterprise admin goes through that process, the token that is generated will reflect the admin permissions, being able to manage the content of users within the enterprise by utilizing the <a href=\"https://box-content.readme.io/reference#as-user-1\" rel=\"nofollow\">As-User Header</a>.</p>\n"},{"owner":{"reputation":1,"user_id":5637873,"user_type":"unregistered","profile_image":"https://www.gravatar.com/avatar/cd4a88851d7b1257368b0e7d03a00cbc?s=128&d=identicon&r=PG","display_name":"ivy","link":"https://stackoverflow.com/users/5637873/ivy"},"is_accepted":false,"score":0,"last_activity_date":1449203456,"creation_date":1449203456,"answer_id":34080941,"question_id":22220942,"body":"<p>For CreateSharedLink method, the HTTP action is PUT. If use POST method, it will return 403 sharedlink access_denied_insufficient_permissions error.\n-Ivy</p>\n"},{"owner":{"reputation":1083,"user_id":5186159,"user_type":"registered","profile_image":"https://lh4.googleusercontent.com/-g_veKof9jo8/AAAAAAAAAAI/AAAAAAAAGxI/iHCRpl2VbhY/photo.jpg?sz=128","display_name":"Brian Campbell","link":"https://stackoverflow.com/users/5186159/brian-campbell"},"is_accepted":false,"score":0,"last_activity_date":1448477958,"creation_date":1448477958,"answer_id":33924437,"question_id":33445955,"body":"<p>The JWT in the example in the question that is the value of the assertion <code>parameter</code> appears to have its parts encoded using regular base64 encoding rather than base64url encoding prescribed by <a href=\"http://tools.ietf.org/html/rfc7519\" rel=\"nofollow\">JWT</a>/<a href=\"http://tools.ietf.org/html/rfc7515\" rel=\"nofollow\">JWS</a>. Many/most base64 implementations are very liberal in decoding and will happily accept base64 or base64url interchangeably. I'd guess that is why, despite that JWT not technically adhering to the specifications, it verifies okay when used directly at something like jwt.io. However, it might cause problems if not properly encoded when sent in the body of the HTTP request, which is expected to be <code>application/x-www-form-urlencoded</code>. The '+', for example, will decode to a space which will be ignored by many base64 decoders. The description in the error you're seeing doesn't seem to line up with that being the problem but it will corrupt the data and be a problem at some point (unless maybe you are url encoding the parameter values and just showing them unencoded in the question). Using base64url rather than base64 will mean that the value of the assertion <code>parameter</code> doesn't need to be url encoded and won't get messed up during url decoding. And base64url will be compliant with JWT. At least it would let you rule out some potential problems. </p>\n"},{"owner":{"reputation":256,"user_id":4339059,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/e34ec5debc4661ceb4fb6474136d142a?s=128&d=identicon&r=PG&f=1","display_name":"Paul Paulauskas","link":"https://stackoverflow.com/users/4339059/paul-paulauskas"},"is_accepted":true,"score":2,"last_activity_date":1448321574,"creation_date":1448321574,"answer_id":33882807,"question_id":33850852,"body":"<p>If you take a look at the <a href=\"https://box-content.readme.io/reference#fields\" rel=\"nofollow\">Fields write up in the documentation</a> it mentions that some fields are not returned by default. Within the docs they are listed in italics in objects, and have to be retrieved by adding a <code>?fields={field name}</code> to your request.</p>\n\n<p>The <a href=\"https://box-content.readme.io/reference#folder-object-1\" rel=\"nofollow\">Folder Object</a> has a <strong><em>tags</em></strong> parameter that you can fetch, but it is one of the ones not returned by default.</p>\n\n<p>In this case, the API call would be <code>GET /folders/{id}?fields=tags</code>. One thing to note is that it will only return the tags in this case with some basic information (type of object and object id), not the full folder object. If you need other information in the call, you can add it to the fields that you want to pull. For example, if you wish to get the <strong>owned_by</strong> parameter as well, your request would be <code>GET /folders/{id}?fields=owned_by,tags</code></p>\n"},{"owner":{"reputation":191,"user_id":4851092,"user_type":"registered","profile_image":"https://i.stack.imgur.com/eLQ20.jpg?s=128&g=1","display_name":"Massimo Della Calce","link":"https://stackoverflow.com/users/4851092/massimo-della-calce"},"is_accepted":false,"score":2,"last_activity_date":1448013762,"creation_date":1448013762,"answer_id":33823866,"question_id":33445955,"body":"<p>The problem seems to be in the public and private key generated using openssl in a DOS command prompt. </p>\n\n<p>You can follow the instructions in this link:\n<a href=\"https://box-content.readme.io/docs/app-auth\" rel=\"nofollow\">https://box-content.readme.io/docs/app-auth</a></p>\n\n<p>First of all, you have to download Cygwin tool: <a href=\"http://www.cygwin.com/\" rel=\"nofollow\">http://www.cygwin.com/</a></p>\n\n<p>Then, in the Cygwin console you can launch the following commands:</p>\n\n<p><strong><em>For the private key</em></strong></p>\n\n<pre><code>openssl genrsa -aes256 -out private_key.pem 2048\n</code></pre>\n\n<p><strong><em>For the public key</em></strong></p>\n\n<pre><code>openssl rsa -pubout -in private_key.pem -out public_key.pem\n</code></pre>\n\n<p>Be sure to include the full header and footer: '-----BEGIN PUBLIC KEY-----' AND '-----END PUBLIC KEY-----'</p>\n\n<p>Once you've generated a public key, you will need to add it in your app's configuration. \nWhen finished you'll get a <strong><em>Public Key ID</em></strong>.</p>\n\n<p>You should be able to connect with your keys using the Box API.</p>\n\n<pre><code>var privateKey = File.ReadAllText(\"private_key.pem\");\n\nvar boxConfig = new BoxConfig(CLIENT_ID, CLIENT_SECRET, ENTERPRISE_ID, privateKey, JWT_PRIVATE_KEY_PASSWORD, JWT_PUBLIC_KEY_ID);\nvar boxJWT = new BoxJWTAuth(boxConfig);\n\nvar adminToken = boxJWT.AdminToken();\nConsole.WriteLine(\"Admin Token: \" + adminToken);\n</code></pre>\n\n<p>I hope this will help you</p>\n"},{"owner":{"reputation":710,"user_id":1949363,"user_type":"registered","accept_rate":100,"profile_image":"https://i.stack.imgur.com/KOMTs.jpg?s=128&g=1","display_name":"srt32","link":"https://stackoverflow.com/users/1949363/srt32"},"is_accepted":true,"score":2,"last_activity_date":1447694455,"creation_date":1447694455,"answer_id":33741061,"question_id":33683246,"body":"<p>The issue here was that I was requesting a token for a non app user and my application was configured to allow access to app users only.</p>\n"},{"owner":{"reputation":76,"user_id":4390432,"user_type":"registered","accept_rate":60,"profile_image":"https://i.stack.imgur.com/2NQcE.jpg?s=128&g=1","display_name":"Paul Pogonoski","link":"https://stackoverflow.com/users/4390432/paul-pogonoski"},"is_accepted":true,"score":1,"last_activity_date":1447621704,"last_edit_date":1447621704,"creation_date":1447609941,"answer_id":33722935,"question_id":33445955,"body":"<p>Right... this is extremely annoying!\nDespite having created correct JWT's for other Public API's, and having the Header and body of the claim, and the signature verified by jwt.io, THE ONLY WAY to get box to accept my JWT was to use the JOSE4J utilities that the Box SDK uses.</p>\n\n<p>This is really poor BOX - lift your game, and support JWT that are valid, not just the proprietary ones created by the JOSE4J classes!!!</p>\n"},{"owner":{"reputation":506,"user_id":1338765,"user_type":"registered","accept_rate":8,"profile_image":"https://graph.facebook.com/520538811/picture?type=large","display_name":"asaf000","link":"https://stackoverflow.com/users/1338765/asaf000"},"is_accepted":false,"score":1,"last_activity_date":1446486158,"creation_date":1446486158,"answer_id":33483655,"question_id":33098778,"body":"<p>Since token lifetime is 60seconds, the time between Box servers and your machine is very sensitive, Make sure that your computer time is synchronized.</p>\n"}],"has_more":true,"quota_max":10000,"quota_remaining":9895}